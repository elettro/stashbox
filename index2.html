<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stashbox | Official Hub</title>
  <meta name="description" content="Stashbox. Music, videos, releases, booking, and partnerships." />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="site">
    <div class="container">
      <div class="nav">
        <a class="brand" href="index.html" aria-label="Stashbox home">
          <span class="logo" aria-hidden="true"></span>
          <span>STASHBOX</span>
        </a>

        <nav class="navlinks" aria-label="Primary">
          <a href="index.html" class="active">Home</a>
          <a href="music.html" class="">Music</a>
          <a href="videos.html" class="">Videos</a>
          <a href="booking.html" class="">Booking</a>
          <a href="partner.html" class="">Partner</a>
          <a href="presskit.html" class="">Press Kit</a>
        </nav>

        <div class="nav-cta">
          <a class="btn ghost" href="https://stashbox.com" target="_blank" rel="noreferrer">Stashbox.com</a>
          <button class="btn menuBtn" id="menuBtn" type="button" aria-expanded="false" aria-controls="mobileNav">Menu</button>
        </div>
      </div>

      <div class="mobile" id="mobileNav" aria-label="Mobile navigation">
        <div class="inner">
          <a href="index.html">Home</a>
          <a href="music.html">Music</a>
          <a href="videos.html">Videos</a>
          <a href="booking.html">Booking</a>
          <a href="partner.html">Partner</a>
          <a href="presskit.html">Press Kit</a>
          <a href="https://youtube.com/@Stashboxband" target="_blank" rel="noreferrer">Subscribe on YouTube</a>
          <a href="https://stashbox.ai" target="_blank" rel="noreferrer">Merch at Stashbox.ai</a>
        </div>
      </div>
    </div>
  </header>

  
<main>
<section class="videoSpotlight">
    <div class="container">
      <div class="kicker">Latest from YouTube</div>
      <h2 style="margin-top:8px;">Subscribe on Youtube to @Stashboxband</h2>
      <p class="small" style="margin-top:8px;">Check out not only the Stashbox music but also all the music with our growing list of collaborations.</p>

      <div class="videoFrame" style="margin-top:14px;">
        <iframe
          id="latestVideoEmbed"
          src="https://www.youtube.com/embed/videoseries?list=UU6C6Z_erONmKW67pF5AyYkA"
          title="Latest Stashbox video"
          loading="lazy"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen></iframe>
      </div>

      <div class="shortsRow" id="shortsRow"></div>
    </div>
  </section>

  <section class="section" id="merch">
    <div class="container">
      <div class="card">
        <div class="sectionHeader">
          <h2>OFFICIAL MERCH</h2>
          <a class="merchLogoLink" href="https://stashbox.ai" target="_blank" rel="noopener noreferrer" aria-label="Open Stashbox.ai merch store in a new window">
            <span class="merchLogoTop">SHOP AT</span>
            <span class="merchLogoMain">STASHBOX.AI</span>
          </a>
          <p>Row 1 shows random products from the Stashbox collection. Row 2 shows random products from the full store.</p>
          <div class="buttonRow">
            <a class="btn" href="https://stashbox.ai/collections/stashbox" target="_blank" rel="noopener noreferrer">
              View Full Collection
            </a>
            <a class="btn" href="https://stashbox.ai" target="_blank" rel="noopener noreferrer">
              Visit Store
            </a>
          </div>
        </div>

        <div class="merchRows">
          <div>
            <h3 class="rowLabel">From the Stashbox Collection</h3>
            <div id="merchCollectionGrid" class="merchGrid"></div>
          </div>

          <div>
            <h3 class="rowLabel">From the Full Store</h3>
            <div id="merchAllGrid" class="merchGrid"></div>
          </div>
        </div>
      </div>
    </div>
  </section>



 


  
  <section class="hero">
    <div class="container">
      <div class="heroGrid">
        <div class="heroCard">
          <div class="kicker">Official Hub</div>
          <h1>Music, videos, and releases from Stashbox.</h1>
          <p class="small" style="margin-top:10px; font-size:1.05rem;">
            One clean place for your newest drops, your best videos, and a fast path to booking.
          </p>

          <div class="artistLinksWrap">
            <h3>Recording Artists &amp; Label Releases</h3>
            <ul class="artistLinksList">
              <li><a href="https://Stashbox.com" target="_blank" rel="noopener noreferrer">Stashbox</a></li>
              <li><a href="https://TheRasBox.com" target="_blank" rel="noopener noreferrer">The Ras Box</a></li>
              <li><a href="https://Stashbox.com/tahiticora" target="_blank" rel="noopener noreferrer">Tahiti Cora</a></li>
              <li><a href="https://Stashbox.com/KariNautique" target="_blank" rel="noopener noreferrer">Kari Nautique</a></li>
            </ul>
          </div>

          <div class="heroActions">
            <a class="btn primary" href="https://youtube.com/@Stashboxband" target="_blank" rel="noreferrer">Subscribe on YouTube</a>
            <a class="btn" href="booking.html">Book Stashbox</a>
       <a class="btn" href="https://stashbox.ai/collections/all" target="_blank" rel="noreferrer">Explore Shopify Merch</a>
          </div>

          <div class="heroMeta">
            <span class="badge">New releases</span>
            <span class="badge">Unreleased videos</span>
            <span class="badge">Custom music</span>
            <span class="badge">Influencer collabs</span>
          </div>
        </div>

        <div class="stack">
          <div class="panel">
            <h3>Quick links</h3>
            <div class="row">
              <div class="small">Stream music on your favorite platform</div>
              <a class="btn" href="https://stashbox.com/music" target="_blank" rel="noreferrer">Stream</a>
            </div>
            <hr class="sep" />
            <div class="row">
              <div class="small">Watch the latest videos and Shorts</div>
              <a class="btn" href="https://stashbox.com/videos" target="_blank" rel="noreferrer">Watch</a>
            </div>
            <hr class="sep" />
            <div class="row">
              <div class="small">Partner pages and influencer program</div>
              <a class="btn" href="partner.html">Partner</a>
            </div>
          </div>

          <div class="panel">
            <div class="kicker">Featured</div>
            <h3 style="margin-top:6px;">Press-ready booking</h3>
            <div class="small" style="margin-top:8px;">
              One page with performance notes, contact routing, and a link to your EPK.
            </div>
            <div style="margin-top:12px;">
              <a class="btn primary" href="presskit.html">Open press kit</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="kicker">What to do next</div>
      <h2 style="margin-top:8px;">Pick a path.</h2>

      <div class="grid3" style="margin-top:14px;">
        <div class="card">
          <h3>Watch</h3>
          <div class="tagline">Best videos and newest drops.</div>
          <div class="meta">
            <span class="pill">YouTube</span>
            <span class="pill">Shorts</span>
            <span class="pill">Live clips</span>
          </div>
          <div style="margin-top:14px;">
            <a class="btn primary" href="videos.html">Go to videos</a>
          </div>
        </div>

        <div class="card">
          <h3>Listen</h3>
          <div class="tagline">Streaming hubs and featured releases.</div>
          <div class="meta">
            <span class="pill">Spotify</span>
            <span class="pill">YouTube Music</span>
            <span class="pill">Apple</span>
          </div>
          <div style="margin-top:14px;">
            <a class="btn primary" href="music.html">Go to music</a>
          </div>
        </div>

        <div class="card">
          <h3>Book</h3>
          <div class="tagline">Events, venues, and private shows.</div>
          <div class="meta">
            <span class="pill">Fast response</span>
            <span class="pill">Pro comms</span>
            <span class="pill">EPK</span>
          </div>
          <div style="margin-top:14px;">
            <a class="btn primary" href="booking.html">Go to booking</a>
          </div>
        </div>
         <div class="card">
          <h3>Merch</h3>
          <div class="tagline">Featured drops from the Stashbox.ai Shopify shop.</div>
          <div class="meta">
            <span class="pill">Shopify</span>
            <span class="pill">Limited drops</span>
            <span class="pill">Fan favorites</span>
          </div>
          <div style="margin-top:14px;">
            <a class="btn primary" href="https://stashbox.ai" target="_blank" rel="noreferrer">Shop merch</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="twoCol">
        <div class="card">
          <div class="kicker">For partners</div>
          <h2 style="margin-top:8px;">Influencer collabs and branded drops.</h2>
          <p class="small" style="margin-top:10px;">
            Put your audience into the music. Launch custom releases, reels, and merch with clean splits and clear deliverables.
          </p>
          <div style="margin-top:12px;">
            <a class="btn primary" href="partner.html">View partner options</a>
            <a class="btn" href="https://stashbox.com/partner" target="_blank" rel="noreferrer">Partner page on Stashbox.com</a>
          </div>
        </div>

        <div class="card">
          <div class="kicker">For fans</div>
          <h2 style="margin-top:8px;">Merch that matches the releases.</h2>
          <p class="small" style="margin-top:10px;">
            Limited drops. Clean designs. Fast path from a song to a product.
          </p>
          <div style="margin-top:12px;">
            <a class="btn primary" href="https://stashbox.ai" target="_blank" rel="noreferrer">Shop Stashbox.ai</a>
            <a class="btn" href="https://stashbox.com/shop" target="_blank" rel="noreferrer">Shop on Stashbox.com</a>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>


  <footer class="footer">
    <div class="container">
      <div class="footerGrid">
        <div>
          <div class="brand" style="margin-bottom:10px;">
            <span class="logo" aria-hidden="true"></span>
            <span>STASHBOX</span>
          </div>
          <div class="small">
            Unreleased videos. New releases. Booking and partnerships.
          </div>
          <div class="small" style="margin-top:10px;">
            Contact: <a href="mailto:booking@stashbox.com">booking@stashbox.com</a>
          </div>
        </div>
        <div>
          <div class="footerLinks">
            <a href="https://youtube.com/@Stashboxband" target="_blank" rel="noreferrer">YouTube</a>
            <a href="https://stashbox.ai" target="_blank" rel="noreferrer">Merch</a>
            <a href="https://stashbox.com/posts" target="_blank" rel="noreferrer">Posts</a>
            <a href="https://stashbox.com/music" target="_blank" rel="noreferrer">Stream</a>
          </div>
          <div class="small" style="margin-top:10px;">
            Â© 2026 Stashbox. All rights reserved.
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script>
    (function(){
      var btn = document.getElementById('menuBtn');
      var mobile = document.getElementById('mobileNav');
      if(!btn || !mobile) return;
      btn.addEventListener('click', function(){
        var open = mobile.classList.toggle('open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
    })();

    
  
    (function(){
      // Paste your channel config here.
      // uploadsPlaylistId should be your channel uploads playlist ID (starts with "UU...").
      const config = {
        uploadsPlaylistId: "UU6C6Z_erONmKW67pF5AyYkA",
        shortsVideoIds: []
      };

      var latestVideoEmbed = document.getElementById('latestVideoEmbed');
      var shortsRow = document.getElementById('shortsRow');
      if (latestVideoEmbed && config.uploadsPlaylistId) {
        latestVideoEmbed.src = 'https://www.youtube.com/embed/videoseries?list=' + encodeURIComponent(config.uploadsPlaylistId);
      }

      if (!shortsRow) return;

      function renderShorts(ids){
        shortsRow.innerHTML = ids.slice(0, 3).map(function(videoId, index){
          var videoUrl = 'https://www.youtube.com/watch?v=' + encodeURIComponent(videoId);
          return '<article class="shortCard">'
            + '<div class="shortThumb">'
            + '<iframe src="https://www.youtube.com/embed/' + encodeURIComponent(videoId) + '" title="Latest Short 0' + (index + 1) + '" loading="lazy" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>'
            + '</div>'
            + '<a class="btn" href="' + videoUrl + '" target="_blank" rel="noreferrer">Watch on YouTube</a>'
            + '</article>';
        }).join('');
      }

      function extractVideoIdsFromXml(xmlText){
        var parser = new DOMParser();
        var xml = parser.parseFromString(xmlText, 'application/xml');
        return Array.prototype.slice.call(xml.getElementsByTagName('yt:videoId')).map(function(node){
          return node.textContent.trim();
        }).filter(Boolean);
      }

      function feedUrlForShortsFromUploads(uploadsPlaylistId){
        var channelId = 'UC' + uploadsPlaylistId.slice(2);
        var shortsPlaylistId = 'UUSH' + uploadsPlaylistId.slice(2);
        return {
          direct: 'https://www.youtube.com/feeds/videos.xml?playlist_id=' + encodeURIComponent(shortsPlaylistId),
          fallback: 'https://www.youtube.com/feeds/videos.xml?channel_id=' + encodeURIComponent(channelId)
        };
      }

      async function fetchText(url){
        var res = await fetch(url);
        if (!res.ok) throw new Error('Failed: ' + url);
        return await res.text();
      }

      async function loadLatestShorts(){
        var manualIds = (config.shortsVideoIds || []).filter(Boolean);
        if (manualIds.length) {
          renderShorts(manualIds);
          return;
        }

        try {
          var urls = feedUrlForShortsFromUploads(config.uploadsPlaylistId);
          var xmlText;

          try {
            xmlText = await fetchText(urls.direct);
          } catch (directErr) {
            try {
              xmlText = await fetchText('https://api.allorigins.win/raw?url=' + encodeURIComponent(urls.direct));
            } catch (proxyErr) {
              xmlText = await fetchText('https://api.allorigins.win/raw?url=' + encodeURIComponent(urls.fallback));
            }
          }

          var ids = extractVideoIdsFromXml(xmlText).slice(0, 3);
          if (ids.length) {
            renderShorts(ids);
            return;
          }
        } catch (err) {
          // fall through to static fallback
        }

        renderShorts(['dQw4w9WgXcQ', '9bZkp7q19f0', '3JZ_D3ELwOQ']);
      }

      loadLatestShorts();
    })();

    (function(){
      function shuffleArray(arr) {
        var copy = arr.slice();
        for (var i = copy.length - 1; i > 0; i -= 1) {
          var j = Math.floor(Math.random() * (i + 1));
          var temp = copy[i];
          copy[i] = copy[j];
          copy[j] = temp;
        }
        return copy;
      }

      function escapeHtml(str) {
        return String(str || '')
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;');
      }

      function formatUsd(price) {
        var amount = Number(price);
        if (Number.isNaN(amount)) return '';
        return '$' + amount.toFixed(2) + ' USD';
      }

      function getProductImage(product) {
        if (product && product.image && product.image.src) return product.image.src;
        if (Array.isArray(product && product.images) && product.images.length) {
          var first = product.images[0];
          if (typeof first === 'string') return first;
          if (first && first.src) return first.src;
        }
        return '';
      }

      function getProductPrice(product) {
        if (Array.isArray(product && product.variants) && product.variants.length) {
          var availableVariant = product.variants.find(function(variant){
            return variant && variant.available;
          }) || product.variants[0];
          if (availableVariant && availableVariant.price != null) return availableVariant.price;
        }
        return null;
      }

      function normalizeProducts(data) {
        var products = Array.isArray(data && data.products) ? data.products : [];
        return products.filter(function(product){
          return Boolean(product && product.handle && product.title);
        });
      }

      function productUrl(product) {
        if (product && product.handle) return 'https://stashbox.ai/products/' + product.handle;
        return 'https://stashbox.ai/collections/stashbox';
      }

      function renderMerchCards(container, products) {
        if (!container) return;

        if (!products.length) {
          container.innerHTML = '<div class="merchMessage">No products available right now.</div>';
          return;
        }

        container.innerHTML = products.map(function(product){
          var title = escapeHtml(product.title || '');
          var image = getProductImage(product);
          var price = getProductPrice(product);
          var href = productUrl(product);

          return '<article class="merchCard">'
            + '<a class="merchImageLink" href="' + href + '" target="_blank" rel="noopener noreferrer">'
            + (image ? '<img src="' + image + '" alt="' + title + '" loading="lazy">' : '<div class="merchNoImage">No image</div>')
            + '</a>'
            + '<div class="merchBody">'
            + '<h4 class="merchTitle">' + title + '</h4>'
            + '<p class="merchPrice">' + (price !== null ? formatUsd(price) : '') + '</p>'
            + '<a class="merchBtn" href="' + href + '" target="_blank" rel="noopener noreferrer">View product</a>'
            + '</div>'
            + '</article>';
        }).join('');
      }

      async function fetchProductsJson(url) {
        var response = await fetch(url, { mode: 'cors' });
        if (!response.ok) throw new Error('HTTP ' + response.status);
        return await response.json();
      }

      async function renderMerchGrids() {
        var collectionGrid = document.getElementById('merchCollectionGrid');
        var allGrid = document.getElementById('merchAllGrid');

        if (!collectionGrid || !allGrid) return;

        collectionGrid.innerHTML = '<div class="merchMessage">Loading collection products...</div>';
        allGrid.innerHTML = '<div class="merchMessage">Loading store products...</div>';

        try {
          var results = await Promise.all([
            fetchProductsJson('https://stashbox.ai/collections/stashbox/products.json?limit=250'),
            fetchProductsJson('https://stashbox.ai/products.json?limit=250')
          ]);

          var collectionProducts = normalizeProducts(results[0]);
          var allProducts = normalizeProducts(results[1]);

          var row1 = shuffleArray(collectionProducts).slice(0, 4);
          var row1Handles = new Set(row1.map(function(product){ return product.handle; }));
          var allFiltered = allProducts.filter(function(product){
            return !row1Handles.has(product.handle);
          });
          var row2Pool = allFiltered.length >= 4 ? allFiltered : allProducts;
          var row2 = shuffleArray(row2Pool).slice(0, 4);

          renderMerchCards(collectionGrid, row1);
          renderMerchCards(allGrid, row2);
        } catch (error) {
          console.error('Merch load error:', error);

          var fallback = '<div class="merchMessage merchError">'
            + 'Could not load products automatically right now. '
            + '<a href="https://stashbox.ai/collections/stashbox" target="_blank" rel="noopener noreferrer">Browse merch here</a>'
            + '</div>';

          collectionGrid.innerHTML = fallback;
          allGrid.innerHTML = fallback;
        }
      }

      renderMerchGrids();
    })();
    
    (function(){
      // Paste your channel config here.
      // uploadsPlaylistId should be your channel uploads playlist ID (starts with "UU...").
      const config = {
        uploadsPlaylistId: "UU6C6Z_erONmKW67pF5AyYkA",
        shortsVideoIds: []
      };

      var latestVideoEmbed = document.getElementById('latestVideoEmbed');
      var shortsRow = document.getElementById('shortsRow');

      function feedUrlForUploads(uploadsPlaylistId){
        return 'https://www.youtube.com/feeds/videos.xml?playlist_id=' + encodeURIComponent(uploadsPlaylistId);
      }

      function feedUrlForLongFormFromUploads(uploadsPlaylistId){
        var longFormPlaylistId = 'UULF' + uploadsPlaylistId.slice(2);
        return 'https://www.youtube.com/feeds/videos.xml?playlist_id=' + encodeURIComponent(longFormPlaylistId);
      }

      function feedUrlForShortsFromUploads(uploadsPlaylistId){
        var channelId = 'UC' + uploadsPlaylistId.slice(2);
        var shortsPlaylistId = 'UUSH' + uploadsPlaylistId.slice(2);
        return {
          direct: 'https://www.youtube.com/feeds/videos.xml?playlist_id=' + encodeURIComponent(shortsPlaylistId),
          fallback: 'https://www.youtube.com/feeds/videos.xml?channel_id=' + encodeURIComponent(channelId)
        };
      }

      function extractFeedEntries(xmlText){
        var parser = new DOMParser();
        var xml = parser.parseFromString(xmlText, 'application/xml');

        return Array.prototype.slice.call(xml.getElementsByTagName('entry')).map(function(entry){
          var idNode = entry.getElementsByTagName('yt:videoId')[0];
          var titleNode = entry.getElementsByTagName('title')[0];

          return {
            id: idNode ? idNode.textContent.trim() : '',
            title: titleNode ? titleNode.textContent.trim() : ''
          };
        }).filter(function(item){
          return Boolean(item.id);
        });
      }

      function extractVideoIdsFromXml(xmlText){
        return extractFeedEntries(xmlText).map(function(item){
          return item.id;
        });
      }

      function looksLikeShortTitle(title){
        var value = (title || '').toLowerCase();
        return value.includes('#shorts') || value.includes(' youtube short') || value.endsWith(' shorts');
      }

      async function fetchText(url){
        var res = await fetch(url);
        if (!res.ok) throw new Error('Failed: ' + url);
        return await res.text();
      }

      async function fetchFeedWithProxyFallback(feedUrl){
        try {
          return await fetchText(feedUrl);
        } catch (directErr) {
          return await fetchText('https://api.allorigins.win/raw?url=' + encodeURIComponent(feedUrl));
        }
      }

      async function fetchJsonWithProxyFallback(url){
        try {
          return JSON.parse(await fetchText(url));
        } catch (directErr) {
          var proxied = await fetchText('https://api.allorigins.win/raw?url=' + encodeURIComponent(url));
          return JSON.parse(proxied);
        }
      }

      async function looksLikeShortByOEmbed(videoId){
        var oembedUrl = 'https://www.youtube.com/oembed?url=' + encodeURIComponent('https://www.youtube.com/watch?v=' + videoId) + '&format=json';

        try {
          var data = await fetchJsonWithProxyFallback(oembedUrl);
          var width = Number(data.thumbnail_width || 0);
          var height = Number(data.thumbnail_height || 0);
          if (!width || !height) return null;
          return height > width;
        } catch (err) {
          return null;
        }
      }

      async function selectLatestNonShortUpload(uploadEntries, shortIdSet){
        var candidates = uploadEntries.filter(function(entry){
          return !shortIdSet.has(entry.id) && !looksLikeShortTitle(entry.title);
        });

        if (!candidates.length) {
          candidates = uploadEntries.filter(function(entry){
            return !shortIdSet.has(entry.id);
          });
        }

        if (!candidates.length) {
          candidates = uploadEntries.slice();
        }

        for (var i = 0; i < Math.min(candidates.length, 6); i += 1) {
          var isShort = await looksLikeShortByOEmbed(candidates[i].id);
          if (isShort === false) return candidates[i];
        }

        return candidates[0];
      }

      async function loadLatestUpload(){
        if (!latestVideoEmbed || !config.uploadsPlaylistId) return;

        latestVideoEmbed.src = 'https://www.youtube.com/embed/videoseries?list=' + encodeURIComponent(config.uploadsPlaylistId);

        try {
          try {
            var longFormXmlText = await fetchFeedWithProxyFallback(feedUrlForLongFormFromUploads(config.uploadsPlaylistId));
            var longFormEntries = extractFeedEntries(longFormXmlText);
            if (longFormEntries.length) {
              latestVideoEmbed.src = 'https://www.youtube.com/embed/' + encodeURIComponent(longFormEntries[0].id);
              return;
            }
          } catch (longFormErr) {
            // continue to uploads/shorts fallback logic
          }

          var uploadsXmlText = await fetchFeedWithProxyFallback(feedUrlForUploads(config.uploadsPlaylistId));
          var uploadEntries = extractFeedEntries(uploadsXmlText);
          if (!uploadEntries.length) return;

          var shortIds = [];
          try {
            var shortsUrls = feedUrlForShortsFromUploads(config.uploadsPlaylistId);
            var shortsXmlText;
            try {
              shortsXmlText = await fetchFeedWithProxyFallback(shortsUrls.direct);
            } catch (shortsDirectErr) {
              shortsXmlText = await fetchFeedWithProxyFallback(shortsUrls.fallback);
            }
            shortIds = extractVideoIdsFromXml(shortsXmlText);
          } catch (shortsErr) {
            shortIds = [];
          }

          var shortIdSet = new Set(shortIds);
          var latestRegularVideo = await selectLatestNonShortUpload(uploadEntries, shortIdSet);

          if (latestRegularVideo && latestRegularVideo.id) {
            latestVideoEmbed.src = 'https://www.youtube.com/embed/' + encodeURIComponent(latestRegularVideo.id);
          }
        } catch (err) {
          // keep playlist fallback already set
        }
      }

      function renderShorts(ids){
        if (!shortsRow) return;

        shortsRow.innerHTML = ids.slice(0, 3).map(function(videoId, index){
          var videoUrl = 'https://www.youtube.com/watch?v=' + encodeURIComponent(videoId);
          return '<article class="shortCard">'
            + '<div class="shortThumb">'
            + '<iframe src="https://www.youtube.com/embed/' + encodeURIComponent(videoId) + '" title="Latest Short 0' + (index + 1) + '" loading="lazy" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>'
            + '</div>'
            + '<a class="btn" href="' + videoUrl + '" target="_blank" rel="noreferrer">Watch on YouTube</a>'
            + '</article>';
        }).join('');
      }

      async function loadLatestShorts(){
        if (!shortsRow || !config.uploadsPlaylistId) return;

        var manualIds = (config.shortsVideoIds || []).filter(Boolean);
        if (manualIds.length) {
          renderShorts(manualIds);
          return;
        }

        try {
          var urls = feedUrlForShortsFromUploads(config.uploadsPlaylistId);
          var xmlText;

          try {
            xmlText = await fetchFeedWithProxyFallback(urls.direct);
          } catch (directErr) {
            xmlText = await fetchFeedWithProxyFallback(urls.fallback);
          }

          var ids = extractVideoIdsFromXml(xmlText).slice(0, 3);
          if (ids.length) {
            renderShorts(ids);
            return;
          }
        } catch (err) {
          // fall through to static fallback
        }

        renderShorts(['dQw4w9WgXcQ', '9bZkp7q19f0', '3JZ_D3ELwOQ']);
      }

      loadLatestUpload();
      loadLatestShorts();
    })();
  </script>
</body>
</html>
